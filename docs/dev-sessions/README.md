# 開発セッション（dev-sessions）

このディレクトリは、開発セッション（dev-sessions）の記録ファイルとテンプレートを置く場所です。

- **セッションの定義（セッションとは）**: `docs/dev-sessions/session-definition.md`
- 本READMEは、主に **dev-sessions の運用・命名・手順**を扱います

## 目的

- 短時間の作業でも迷わず進められるように、**事前に計画を立ててから実装に入る**習慣を作る
- AIと協力して開発する際の「壁打ち→計画→チェックリスト→プロンプト設計→実行」の流れを1ファイルで完結させる
- セッションごとの学びや持ち越しタスクを記録し、次回のセッションに活かす

## 使い方

### 1. 新しいセッションを始める

1. **保存先フォルダ（年/月）を用意**:
   ```bash
   YYYYMMDD=$(date +%Y%m%d)  # 例: 20251210
   YYYY=${YYYYMMDD:0:4}      # 例: 2025
   MM=${YYYYMMDD:4:2}        # 例: 12
   mkdir -p "docs/dev-sessions/${YYYY}/${MM}"
   ```

2. **日付と連番を決定**（AI作業時は必須）:
   ```bash
   # その日の既存ファイルを確認して連番を決定
   ls "docs/dev-sessions/${YYYY}/${MM}/${YYYYMMDD}-"*.md | sort | tail -1
   # 例: 20251210-02-session-name.md が最後なら、次の連番は 03
   ```

3. **テンプレートをコピー**:
   ```bash
   cp docs/dev-sessions/template-session.md "docs/dev-sessions/${YYYY}/${MM}/${YYYYMMDD}-連番-説明.md"
   ```

4. **ファイル名の形式**: `YYYY/MM/YYYYMMDD-連番-説明.md`
   - `連番` は2桁の数字（`01`, `02`, `03`...）
   - `説明` はセッションの内容を表す短い文字列（例: `phase9-instagram-search-api`）

### 2. セッションファイルを埋める

テンプレートに沿って、以下の順序で記入します：

#### ① セッション概要とゴール
- 概要（このセッションでやることの一言サマリ）
- 対応フェーズ / セッション種別 / 影響範囲 / 日付 / 想定所要時間
- ゴール（1つ。必要に応じて完了条件・補足を箇条書きで追記）

#### ② 前提・合意事項（事前議論・壁打ちメモ）
- **今日のセッションで前提とする方針**: このセッションで採用する方針や前提
- **議論概要**: AIや自分との壁打ちで話したことのサマリ
- **保留中の論点**: 今回は触らないと決めたこと / 後回しにする論点

#### ③ 実装チェックリスト（本セッションにおける）
- **作業タスク & プロンプト設計**: 
  - 各タスクを「1回のAI指示（プロンプト）で完結する粒度」まで分解
  - 目安: **1タスク = 1プロンプト + 確認まで15〜30分**
  - 各タスクに「完了条件」と「実行プロンプト案」を記述
- **検証・テスト**: 確認方法と期待結果をチェックリスト化

#### ④ 実施ログ
- 作業中の気づき・試したこと・判断理由をメモ

#### ⑤ 結果とふりかえり
- 完了できたタスク（チェックリストを `[x]` に更新）
  - **チェックの付け方**: 
    - タスクは開始時点では `- [ ]`（未完了）で記述する
    - タスクが完了したら、実装チェックリストの該当行を `- [x]` に更新し、「結果とふりかえり」セクションでも `- [x]` で列挙する
    - ゴールの完了条件も `- [ ]` のチェックリストで書き、満たしたら `- [x]` に更新する（✅は使わない）
- 未完了タスク / 想定外だったこと
- 学び・次回改善したいこと

#### ⑥ 次回に持ち越すタスク
- **目的**: 次回セッション開始時に「前回の続き」を迷わず再開できるようにする
- **運用（重要）**:
  - **持ち越しタスクの正本は、常に「最新のセッションファイル 1つ」に集約**する（= これだけ見れば良い状態にする）
  - 次のセッションを作ったら、前回セッションの未完了タスクを **最新セッション** の「次回に持ち越すタスク」へ **コピー**して集約する
  - 以降、前回セッション側の「次回に持ち越すタスク」は **増やさない**（後から追記しない）
  - もし後日「漏れていたタスク」に気づいた場合は、**最新セッションにのみ追記**し、行末に `（漏れていたため追加: YYYY-MM-DD）` を付ける

#### ⑦（運用ルール）過去セッションの「持ち越し」を完了でクローズする

- **基本**: 過去セッションの「次回に持ち越すタスク」は、後日 **必ずクローズ**して「前回の持ち越しを追うために過去ファイルを見ない」運用にする。
- **クローズ方法（2パターン）**:
  - **A. 完了した場合**:
    - 元のセッションファイルで対象行を `- [x]` にする
    - **完了日**と、完了したセッションへの**参照リンク**を付ける
      - 例: `- [x] ○○○ - 2025-12-14（[dev-session](./YYYYMMDD-..-....md)）`
  - **B. 次回セッションへ移した場合（持ち越し済み）**:
    - 元のセッションファイルで対象行を `- [x]` にする（※この `x` は **「完了」ではなく「このファイル上はクローズ」** の意味）
    - 行末に `（持ち越し済み → [dev-session](./YYYYMMDD-..-....md)）` を付ける
    - **未完了の正本**は、リンク先（最新セッション）の「次回に持ち越すタスク」に集約する
- **狙い**: 「持ち越しが雪だるま式に増えて、どれが最新かわからない」を防ぐ（= 常に最新の1ファイルだけ見れば良い状態）


### 3. セッションの流れ

```
1. 壁打ち（AIと議論）
   ↓
2. 前提・合意事項を記録
   ↓
3. 実装チェックリストを作成
   - タスクを1プロンプト単位に分解
   - 各タスクのプロンプト案を設計
   ↓
4. チェックリストに沿って実装
   - プロンプト案をコピペしてAIに指示
   ↓
5. 検証・テストを実行
   ↓
6. 結果とふりかえりを記録
   - 完了タスクにチェック
   - 持ち越しタスクを次回にコピー
```

## テンプレート

- **テンプレートファイル**: [`template-session.md`](./template-session.md)
- テンプレートには「チェックリスト式実装計画書」の構造が組み込まれており、きのぴーさんが提唱する手法をベースにしています

## ファイル命名規則

- パス形式: `docs/dev-sessions/YYYY/MM/YYYYMMDD-連番-説明.md`
- 例:
  - `2025/12/20251210-01-phase9-instagram-search-api.md`
  - `2025/12/20251210-02-phase9-instagram-search-api.md`（同日の2回目）

## 日付の付け方（AI作業時の標準フロー）

**AIが作業する際の必須手順**:

1. **現在日付を取得する**（必ずコマンドで確認）:
   ```bash
   date +%Y%m%d  # 例: 20251210
   ```

2. **その日の既存ファイルを確認し、連番を決定する**:
   ```bash
   YYYYMMDD=$(date +%Y%m%d)
   YYYY=${YYYYMMDD:0:4}
   MM=${YYYYMMDD:4:2}
   ls "docs/dev-sessions/${YYYY}/${MM}/${YYYYMMDD}-"*.md | sort | tail -1
   # 例: 20251210-02-session-name.md が最後のファイルの場合
   # 次の連番は 03
   ```
   - 既存ファイルがない場合、連番は `01` から開始
   - 既存ファイルがある場合、最大連番+1を新しい連番とする

3. **ファイル名と本文の日付を生成する**:
   - ファイル名: `docs/dev-sessions/YYYY/MM/YYYYMMDD-連番-説明.md`
   - 本文の「日付: YYYY-MM-DD」: `YYYYMMDD` 形式を `YYYY-MM-DD` 形式に変換
     - 変換方法: `${YYYYMMDD:0:4}-${YYYYMMDD:4:2}-${YYYYMMDD:6:2}`
     - 例: `20251210` → `2025-12-10`

**禁止事項**:
- ❌ AIの内部的な「今日の日付」を推測して使用すること
- ❌ 既存ファイルの日付をコピーして使用すること
- ❌ 手入力で日付を書くこと
- ❌ 連番を確認せずにファイルを作成すること

詳細は [`docs/05-00-development-phases.md`](../05-00-development-phases.md) の「dev-sessions ファイルの日付の付け方（AI作業時の標準フロー）」も参照してください。

## 関連ドキュメント

- [`docs/05-00-development-phases.md`](../05-00-development-phases.md): 開発フェーズの定義と運用ルール
- [`docs/README.md`](../README.md): ドキュメント全体の構成インデックス
