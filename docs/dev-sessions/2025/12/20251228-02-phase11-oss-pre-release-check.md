# チェックリスト式実装計画書: 2025-12-28

> **セッションとは**: このプロジェクトにおける「セッションの定義」は `docs/dev-sessions/session-definition.md` を参照。
>
> **重要（AI作業時）**: このセッションファイルは `date` コマンドで現在日付（`20251228`）を取得したうえで作成している。

## セッション概要とゴール

### 概要

- 一言サマリ: OSS公開前チェック（secret / log / license / README）だけを実施し、公開して問題ない状態にするための修正点を確定する
- 対応フェーズ: フェーズ11（デザイン / UX 仕上げ & リリース準備）
- セッション種別: 運用整備 / 公開前チェック（セキュリティ・法務寄り）
- 実行方式: AI自律（ただし、シークレット取り扱い・外部送信・破壊的操作は人の明示確認を必須とする）
- 影響範囲: リポジトリ全体（ドキュメント / 設定 / スクリプト / フロント）
- 日付: 2025-12-28
- 想定所要時間: 25〜60 分

### ゴール

> **チェックの付け方（完了条件）**:
> - 完了条件は **Markdownのチェックリスト**（`- [ ]`）で記述する（セッション開始時点では未チェック）
> - セッションの最後に、満たした完了条件を `- [x]` に更新する（ゴール達成のセルフチェック）
> - ✅（絵文字）のチェックは使わない（`- [ ]` / `- [x]` に統一）

- **ゴール**: OSS公開前チェックの結果が「判断可能な形」で残り、必要修正があればパッチ単位で着手できる
  - 完了条件:
    - [ ] **secrets**: コード/ドキュメント/サンプルenvに、実シークレット・個人情報・トークンが含まれていないと確認できている（疑わしければファイル/行で列挙）
    - [ ] **logs**: 環境変数やトークンをログ出力していない（特に `process.env.*` を `console.*` していない）と確認できている
    - [ ] **license**: `LICENSE` の有無を確認し、無い場合は「採用するライセンス種別」を決めて追加タスク化できている
    - [ ] **readme**: 公開READMEに、最低限のセットアップ/注意事項（シークレットの扱い、免責）が過不足なく記載されていると確認できている
  - 補足:
    - CodeRabbitは使わず Cursor だけで実施する
    - 外部サービスへのキー入力・課金が発生する操作は、このセッションでは行わない

### 関連ドキュメント

- 参照:
  - `README.md`
  - `docs/README.md`
  - `docs/04-development.md`（環境変数/運用ポリシー、スクレイピングガイドライン等）
  - `apps/web/env.local.example`（サンプルenvに実値が混入していないこと）
  - `docs/dev-sessions/2025/12/20251228-01-phase11-mvp-release-prep.md`（前回の大枠。OSSチェックのみを切り出し）

## 前提・合意事項（事前議論・壁打ちメモ）

- 今日のセッションで前提とする方針:
  - 目的は「OSSとして公開して問題ない状態か」を最小観点で判断し、必要修正を列挙すること
  - “公開可能”の判断は、少なくとも **LICENSEの明示 / シークレット混入なし / ログに秘匿情報なし** を満たす
  - 迷う箇所は「安全側（公開しない・伏せる）」に倒す
- 議論概要:
  - MVPスコープを絞り、公開前チェックを最優先で進める（Cursorのみ）
- 保留中の論点 / 今回は触らないと決めたこと:
  - 一般ユーザー投稿/ログイン等の機能追加
  - 仕様追加や大規模リファクタ（公開前チェックに直結しない）

---

## 実装チェックリスト（本セッションにおける）

### 1. 作業タスク & 実行内容（実装・ドキュメント更新）

- [ ] タスク1: secrets混入チェック（コード/ドキュメント/サンプルenv）
  - 完了条件: 「OK」または「要修正（ファイル/理由/対応案）」で結論が出ている
  - **AIが実行する内容（手順/プロンプト/操作メモ）**:
    ```
    - 参照ファイル:
      - apps/web/env.local.example
      - docs/04-development.md
      - README.md
    - やりたいこと:
      - 典型パターンをgrepで検出: "SUPABASE_SERVICE_ROLE_KEY", "ADMIN_API_TOKEN", "GOOGLE_CSE_API_KEY", "BEGIN PRIVATE KEY", "sk-", "AKIA", "-----BEGIN", "password", "token"
      - .env / .env.local / 秘匿っぽいファイルがgit追跡されていないか確認（git status / git ls-files）
      - 検出結果を「誤検知/要対応」に分類して記録
    - 制約・注意点:
      - 実シークレット値は絶対にログ/コメント/コミットメッセージに含めない
      - もし実値が見つかった場合は、公開前にローテーションが必要になり得るため、即座に隔離して対応方針を決める
    ```

- [ ] タスク2: ログ/外部送信チェック（秘匿情報の出力・送信が無いか）
  - 完了条件: `console.*` やエラーログに `process.env` を出していないと判断できる
  - **AIが実行する内容（手順/プロンプト/操作メモ）**:
    ```
    - 参照ファイル:
      - apps/web/ (Next.js)
      - apps/scripts/
    - やりたいこと:
      - console.log / console.error の近傍で env を出していないか検索
      - fetch/curl等でトークンを含む外部送信が無いか（特にスクリプト）確認
      - 必要なら「ログの伏せ方（例: 末尾だけ表示）」の修正案を作る
    - 制約・注意点:
      - 解析結果の共有でも、実値を貼らない（キー名だけで記録する）
    ```

- [ ] タスク3: LICENSE/READMEの公開整備（最小）
  - 完了条件: LICENSEの方針と、READMEに追記すべき最小項目（必要なら）を決められている
  - **AIが実行する内容（手順/プロンプト/操作メモ）**:
    ```
    - 参照ファイル:
      - README.md
      - docs/README.md
      - docs/04-development.md（スクレイピング/運用ポリシー）
    - やりたいこと:
      - LICENSEファイルの有無確認（無い場合は「どのライセンスにするか」を決める）
      - READMEに「.env.localをコミットしない」「キーをログ出力しない」等の注意が不足していないか確認
      - Instagram/Google CSE等の外部サービス利用について、過剰にならない範囲で注意書きを入れるか判断
    - 制約・注意点:
      - ここでは文章と方針の確定まで。必要修正は次セッションで小さく実施する
    ```

### 2. 検証・テスト（確認方法）

- [ ] 確認1: `git status` / `git ls-files` で `.env*` などが追跡されていない
      - 期待結果: `.env.local` 等がコミット対象に出てこない
- [ ] 確認2: grep結果をレビューして「実シークレット混入なし」を判断できる
      - 期待結果: 検出はキー名/ダミーのみで、実値が無い（または要修正が列挙されている）
- [ ] 確認3: LICENSE方針が決まり、必要なら追加タスクとして起票（このファイルに記録）できている
      - 期待結果: 「採用ライセンス: XXX」「次アクション: LICENSE追加」が明記されている

---

## 実施ログ

- スタート: TODO
- メモ:
  - TODO: 検出した懸念点（ファイル/理由/対応案）をここに追記

## 結果とふりかえり

> **チェックの付け方**: 完了したタスクは `- [x]` で列挙する。未完了のタスクは `- [ ]` のまま「次回に持ち越すタスク」へ移す。

- 完了できたタスク:
  - [ ] タスク1: secrets混入チェック
  - [ ] タスク2: ログ/外部送信チェック
  - [ ] タスク3: LICENSE/READMEの公開整備（最小）
- 未完了タスク / 想定外だったこと:
  - TODO
- 学び・次回改善したいこと:
  - TODO

## 次回に持ち越すタスク

> **運用（重要）**:
> - 持ち越しタスクの**正本は常に「最新のセッションファイル 1つ」に集約**する（= 次回は最新だけ見れば良い状態にする）
> - 次のセッションを作ったら、前回セッションの未完了タスクを **新しい（最新）セッション** のこのセクションへコピーする
> - 前回セッション側のこのセクションは、後日 **各行を `- [x] （持ち越し済み → ...）` に更新して凍結**する（ここに追記して増やさない）
> - 後日「漏れていたタスク」に気づいた場合は、**最新セッションにのみ追記**し、行末に `（漏れていたため追加: YYYY-MM-DD）` を付ける

- なし（持ち越しが無い場合）

***

## 付録（任意）

> メモ: ここにはgrep結果の「要約」だけを貼り、実値（シークレットや個人情報）は絶対に貼らない。


