# create-dev-session（フェーズ詳細タスクからdev-sessionsを作成）

## 概要

フェーズ9以降は、フェーズごとの詳細タスクを `docs/05-<フェーズ番号>-*.md` に事前に作成し、
その中から「今回のセッションでやるタスク（1〜3個）」を選んで AI が `docs/dev-sessions/YYYY/MM/` にセッションファイルを作成し、
`docs/dev-sessions/template-session.md` を埋めるためのカスタムコマンドです。

- 対象フェーズと本セッションで取り組むタスク（1〜3個）を決める
- `docs/dev-sessions/template-session.md` をもとに新しいセッションファイルを作成
- 壁打ち結果・チェックリスト・プロンプト案をテンプレートに落とし込む

## 前提

- 事前に、対象フェーズの詳細計画が `docs/05-<フェーズ番号>-*.md` として作成されていること
  - まだない場合は `docs/phase-planning/phase-planning.md`（作成ガイド）に従い、`docs/phase-planning/template-phase-detail.md` をコピーして作成する
  - フェーズ1〜8など、詳細ファイルが無い/作らない場合は `docs/05-00-development-phases.md` の該当フェーズ節を起点に、今回のタスクを選ぶ
- dev-sessions の運用ルールは `docs/dev-sessions/README.md` に記載されている
- 日付と連番の決め方は `docs/05-00-development-phases.md` の
  「dev-sessions ファイルの日付の付け方（AI作業時の標準フロー）」に従う
- `docs/05-00-development-phases.md` は全体の索引（高レベル）であり、対象フェーズの詳細計画と進捗管理の正本は `docs/05-<フェーズ番号>-*.md` とする（テンプレを埋める際は、必要な抜粋だけを転記する）

## 実行してほしいこと

1. **今回のセッション範囲の確定**  
   - 対象フェーズの詳細計画（`docs/05-<フェーズ番号>-*.md`）の「進捗チェックリスト（正本）」と「実装計画」を起点に、
     **「今回のセッションで着手するタスク」を1〜3個に絞る**。
   - あわせて、以下の情報も参照し、今回のタスク選定に反映する（計画の正本はあくまで `docs/05-<フェーズ番号>-*.md`）:
     - 直近のセッションファイル（`docs/dev-sessions/YYYY/MM/` の最新）にある「未完了 / 次回候補 / 課題 / 宿題」
     - 開発者との議論・合意（例: Issue/PRコメント、チャットログ、設計メモ等）
     - 関連する制約や前提（API仕様、運用ルール、既知のバグ・リスク）
   - すでに完了（`- [x]`）になっているタスクは原則選ばない（例外: 追加の検証や改善が必要な場合は、目的を明記して選ぶ）
   - 各タスクについて:
     - 対象フェーズ（例: フェーズ9）
     - タスク名
     - 完了条件
     - 実行プロンプト案（参照ファイル / やりたいこと / 制約）
     を整理する。

2. **ファイル名と日付の決定（説明）**  
   AI が次のルールに従って **実際にコマンドを実行し**、ファイルパスを確定して作成する：
   - 現在日付の取得:
     ```bash
     date +%Y%m%d  # 例: 20251210
     ```
   - その日の既存ファイルから連番を決定:
     ```bash
     YYYYMMDD=$(date +%Y%m%d)
     YYYY=${YYYYMMDD:0:4}
     MM=${YYYYMMDD:4:2}
     mkdir -p "docs/dev-sessions/${YYYY}/${MM}"
     ls "docs/dev-sessions/${YYYY}/${MM}/${YYYYMMDD}-"*.md | sort | tail -1
     # 既存ファイルがなければ 01、あれば最大連番+1
     ```
   - ファイル名の形式:
     - `docs/dev-sessions/YYYY/MM/YYYYMMDD-連番-説明.md`
     - 例: `docs/dev-sessions/2025/12/20251210-01-phase9-instagram-account-coverage.md`

3. **テンプレートから新規ファイルを作成**  
   - AI は `docs/dev-sessions/template-session.md` をベースに **新規ファイルを実際に作成し、保存**する。
   - 作成するセッションファイルでは、少なくとも以下を埋める：
     - **メタ情報**
       - 日付（`YYYY-MM-DD` 形式）
       - 想定所要時間
       - 対応フェーズ（例: フェーズ9）
     - **今日のゴール（最大3つ）**
       - 1〜3個のタスクを、アウトカムベースで要約
     - **前提・合意事項（事前議論・壁打ちメモ）**
       - `docs/05-<フェーズ番号>-*.md` に書かれている方針や、今回のセッションで前提とする決定事項を2〜5行程度で要約
       - フェーズ計画の全文は原則貼らない（必要に応じて付録に抜粋を置き、正本が `docs/05-<フェーズ番号>-*.md`（高レベル索引は `docs/05-00-development-phases.md`）である旨を明記）
     - **チェックリスト式実装計画書（このセッション）**
       - 「作業タスク & プロンプト設計」セクションに、今回のタスク1〜3個だけを転記（`docs/05-<フェーズ番号>-*.md` のタスク群を丸ごと貼るのではなく必要分だけ）
       - 各タスクに完了条件と実行プロンプト案を記述
     - **検証・テスト**
       - 今回のタスクで実行すべき確認方法と期待結果を記述

4. **出力フォーマット**  
   - AI は **新規セッションファイルを実際に作成・保存**し、回答では最低限つぎを提示する（Markdown）:
     - **作成したファイルのパス（確定した1つ）**
     - **今回のタスク（1〜3個）の要約**（各タスクの完了条件つき）
     - **「次回に持ち越すタスク」** に列挙した内容（今回やらない理由/着手条件つき）
   - 未確定の情報はセッションファイル内に `TODO:` として残し、何を埋めるべきか（例: 所要時間、前提リンク、検証手順）を明示する。

## 留意事項

- このコマンドは「フェーズ詳細タスクを dev-sessions の1セッションに具体化する」ためのものです
- 1セッションに詰め込みすぎないように、**タスク数は1〜3個（原則最大3）** とする
- 今回選ばなかったタスクは、**必ず「次回に持ち越すタスク」として列挙**し、各項目に以下を添える:
  - 今回やらない理由（例: 前提が不足、調査が先、依存が未解決、スコープ外）
  - 次回の着手条件/前提（例: 先にこのPRをmerge、APIの仕様確定、データ準備）

